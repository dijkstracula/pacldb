{% extends "layout.html" %}

{% from "macros.html" import render_pagination_link %}

{% block content %}


<hr class="no-margins"/>

<div class="container-fluid">
    <div class="row">
        <div class="col-4">
            Displaying results {{pagination_state.begin_cnt}} to {{pagination_state.end_cnt}} of {{results.total}}
        </div>
        <div class="col-7">
            {% set first_page = ([pagination_state.page-1,1] | sort)[-1] %}
            <nav aria-label="Page navigation">
              <ul class="pagination justify-content-end">
                <li class="page-item {% if not pagination_state.prev_url %}disabled{% endif %}">
                  <a class="page-link" href="{{pagination_state.prev_url}}" tabindex="-1">&laquo;</a>
                </li>
				  {%- for page in results.iter_pages() %}
					{% if page %}
					  {% if page != results.page %}
						{{ render_pagination_link(page, form) }}
					  {% else %}
						<strong>{{ render_pagination_link(page, form) }}</strong>
					  {% endif %}
					{% else %}
					  <span class=ellipsis>…</span>
					{% endif %}
				  {%- endfor %}
                <li class="page-item {% if not pagination_state.next_url %}disabled{% endif %}">
                  <a class="page-link" href="{{pagination_state.next_url}}">&raquo;</a>
                </li>
              </ul>
            </nav>
        </div>
		<div class="col-1">
			<div class="dropdown" id="column-select-checkboxes">
				<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
					Cols
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu checkbox-menu allow-focus">
				  <li><label><input type="checkbox" name="domain" checked>Domain</input></label></li>
				  <li><label><input type="checkbox" name="concept" checked>Concept</input></label></li>
				  <li><label><input type="checkbox" name="ortho" checked>Orthography</input></label></li>
				  <li><label><input type="checkbox" name="stem" checked>Stem</input></label></li>
				  <li><label><input type="checkbox" name="ipa" checked>IPA</input></label></li>
				  <li><label><input type="checkbox" name="morph" checked>Morph</input></label></li>
				  <li><label><input type="checkbox" name="language" checked>Language</input></label></li>
				  <li><label><input type="checkbox" name="glosses" checked>Glosses</input></label></li>
				</ul>
			</div>
		</div>
    </div>
</div>
<table class="table table-bordered table-striped table-responsive table-sm" cellspacing="0">
    <thead>
        <tr>
            <th class="th-sm domain" scope="col">Domain</th>
            <th class="th-sm concept" scope="col">Concept</th>
            <th class="th-sm ortho" scope="col">Source Orthography</th>
            <th class="th-sm stem" scope="col">Stem</th>
            <th class="th-sm ipa" scope="col">IPA <small>(regex)</small></th>
            <th class="th-sm morph" scope="col">Morph</th>
            <th class="th-sm language" scope="col">Language</th>
            <th class="th-sm glosses" scope="col">Glosses</th>
        </tr>
        <form method="POST" class="form" role="form">
            {{ form.hidden_tag() }}
            <tr>
                <td class="domain"> 
                    {{ form.domain(onchange="this.form.submit()") }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="concept">
                    {{ form.concept(placeholder="search")  }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="ortho">
                    {{ form.orthography(placeholder="search")  }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="stem">
                    {{ form.stem_form(placeholder="search")  }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="ipa">
                    {{ form.ipa(placeholder="search")  }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="morph">
                    {{ form.morph_type(onchange="this.form.submit()") }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="language">
                    {{ form.language(onchange="this.form.submit()") }}
                    <a href= "#" class="sort-by">⇕</a>
                </td>
                <td class="glosses">
                    {{ form.gloss(placeholder="search")  }}
                </td>
            </tr>
            <input type="submit" style="display:none">
        </form>
    </thead>
    <tbody>

        {% for result in results.items %}
        <tr>
            <td class="domain">{{result.concept.domain.name}}</td>
            <td class="concept">{{result.concept.name}}</td>
            <td class="ortho"><strong>{{result.orthography}}</strong></td>
            <td class="stem">{{result.stem_form}}</td>
            <td class="ipa">{{result.ipa}}</td>
            <td class="morph">{{result.morph.name}}</td>
            <td class="language">{{result.language.name}}</td>
            <td class="glosses">
                {% for gloss in result.glosses %}
                [<a href="#" data-toggle="tooltip" title='{{ gloss.source}} page {{ gloss.page  }}'>{{gloss.gloss}}</a>]
                {%endfor %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script type="text/javascript" src="{{ url_for('static', filename='js/search.js') }}"></script>
{% endblock %}
